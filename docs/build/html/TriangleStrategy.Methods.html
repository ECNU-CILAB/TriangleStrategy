<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>TriangleStrategy.Methods package &mdash; TriangleStrategy 1.0.0 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="TriangleStrategy package" href="TriangleStrategy.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> TriangleStrategy
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">API Docs</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="TriangleStrategy.html">TriangleStrategy package</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">TriangleStrategy.Methods package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-TriangleStrategy.Methods.A2C">TriangleStrategy.Methods.A2C module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-TriangleStrategy.Methods.DDPG">TriangleStrategy.Methods.DDPG module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-TriangleStrategy.Methods.DQN">TriangleStrategy.Methods.DQN module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-TriangleStrategy.Methods.DQNA">TriangleStrategy.Methods.DQNA module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-TriangleStrategy.Methods.OASS">TriangleStrategy.Methods.OASS module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-TriangleStrategy.Methods.PG">TriangleStrategy.Methods.PG module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-TriangleStrategy.Methods.PPO">TriangleStrategy.Methods.PPO module</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="TriangleStrategy.html#module-TriangleStrategy.Environment">TriangleStrategy.Environment module</a></li>
<li class="toctree-l2"><a class="reference internal" href="TriangleStrategy.html#module-TriangleStrategy.ModelArchitecture">TriangleStrategy.ModelArchitecture module</a></li>
<li class="toctree-l2"><a class="reference internal" href="TriangleStrategy.html#module-TriangleStrategy.TrainFunctions">TriangleStrategy.TrainFunctions module</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">TriangleStrategy</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="TriangleStrategy.html">TriangleStrategy package</a> &raquo;</li>
      <li>TriangleStrategy.Methods package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/TriangleStrategy.Methods.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="trianglestrategy-methods-package">
<h1>TriangleStrategy.Methods package<a class="headerlink" href="#trianglestrategy-methods-package" title="Permalink to this headline"></a></h1>
<section id="module-TriangleStrategy.Methods.A2C">
<span id="trianglestrategy-methods-a2c-module"></span><h2>TriangleStrategy.Methods.A2C module<a class="headerlink" href="#module-TriangleStrategy.Methods.A2C" title="Permalink to this headline"></a></h2>
<p>A2C (Advantage Actor-Critic).</p>
<dl class="py class">
<dt class="sig sig-object py" id="TriangleStrategy.Methods.A2C.DecisionMakerA2C">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">TriangleStrategy.Methods.A2C.</span></span><span class="sig-name descname"><span class="pre">DecisionMakerA2C</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">head_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tail_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">device(type='cuda')</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#TriangleStrategy.Methods.A2C.DecisionMakerA2C" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>The decision maker of A2C.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>head_mask (int): <code class="docutils literal notranslate"><span class="pre">head_mask</span></code>.
tail_mask (int): <code class="docutils literal notranslate"><span class="pre">tail_mask</span></code>.
device (torch.device): The computing device.</p>
</dd>
<dt>Attributes:</dt><dd><p>training (bool): If <code class="docutils literal notranslate"><span class="pre">training=True</span></code>, <code class="docutils literal notranslate"><span class="pre">model.train()</span></code> will be called. If <code class="docutils literal notranslate"><span class="pre">training=False</span></code>, <code class="docutils literal notranslate"><span class="pre">model.eval()</span></code> will be called.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="TriangleStrategy.Methods.A2C.DecisionMakerA2C.get_model_output">
<span class="sig-name descname"><span class="pre">get_model_output</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#TriangleStrategy.Methods.A2C.DecisionMakerA2C.get_model_output" title="Permalink to this definition"></a></dt>
<dd><p>Get the raw output of a model.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>model (torch.nn.Module): The neural network model.
input_data (torch.tensor): A batch of sequencial environment states. The shape is <code class="docutils literal notranslate"><span class="pre">(batch_size,</span> <span class="pre">sequence_length,</span> <span class="pre">input_size)</span></code>.
action_data (torch.tensor): A batch of sequencial actions. The shape is <code class="docutils literal notranslate"><span class="pre">(batch_size,</span> <span class="pre">sequence_length)</span></code>. This tensor is generated in trainer.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="TriangleStrategy.Methods.A2C.TrainerA2C">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">TriangleStrategy.Methods.A2C.</span></span><span class="sig-name descname"><span class="pre">TrainerA2C</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">head_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tail_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buy_cost_pct</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sell_cost_pct</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.99</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clamp_bound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">critic_alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">device(type='cuda')</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#TriangleStrategy.Methods.A2C.TrainerA2C" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>The trainer of A2C.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>head_mask (int): <code class="docutils literal notranslate"><span class="pre">head_mask</span></code>.
tail_mask (int): <code class="docutils literal notranslate"><span class="pre">tail_mask</span></code>.
buy_cost_pct (float): The cost ratio when the agent chooses to buy.
sell_cost_pct (float): The cost ratio when the agent chooses to sell.
gamma (float): The discount factor in the reward value function.
clamp_bound (float): The upper bound on the absolute value of the gradients.
critic_alpha (float): The coefficient of critic loss.
device (torch.device): The computing device.</p>
</dd>
<dt>Attributes:</dt><dd><p>difficulty (float): <code class="docutils literal notranslate"><span class="pre">difficulty</span></code>.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="TriangleStrategy.Methods.A2C.TrainerA2C.calculate_loss">
<span class="sig-name descname"><span class="pre">calculate_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decision_maker</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_data_batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buy_price_batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sell_price_batch</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#TriangleStrategy.Methods.A2C.TrainerA2C.calculate_loss" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TriangleStrategy.Methods.A2C.TrainerA2C.test_epoch">
<span class="sig-name descname"><span class="pre">test_epoch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_loader</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#TriangleStrategy.Methods.A2C.TrainerA2C.test_epoch" title="Permalink to this definition"></a></dt>
<dd><p>Test the model for an epoch.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>model (torch.nn.Module): The neural network model.
data_loader (torch.utils.data.DataLoader): The data loader which contains the <code class="docutils literal notranslate"><span class="pre">dev</span> <span class="pre">(or</span> <span class="pre">test)</span></code> dataset.
decision_maker (DecisionMakerA2C): The decision maker that chooses actions according to the model’s output.</p>
</dd>
<dt>Returns:</dt><dd><p>sum_loss, sum_reward (float, float): The average loss and reward of each sequence in the data loader.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TriangleStrategy.Methods.A2C.TrainerA2C.train_epoch">
<span class="sig-name descname"><span class="pre">train_epoch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#TriangleStrategy.Methods.A2C.TrainerA2C.train_epoch" title="Permalink to this definition"></a></dt>
<dd><p>Train the model for an epoch.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>model (torch.nn.Module): The neural network model.
data_loader (torch.utils.data.DataLoader): The data loader which contains the <code class="docutils literal notranslate"><span class="pre">train</span></code> dataset.
optimizer (torch.optim.Adam): The optimizer provided by PyTorch.
decision_maker (DecisionMakerA2C): The decision maker that chooses actions according to the model’s output.</p>
</dd>
<dt>Returns:</dt><dd><p>sum_loss, sum_reward (float, float): The average loss and reward of each sequence in the data loader.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-TriangleStrategy.Methods.DDPG">
<span id="trianglestrategy-methods-ddpg-module"></span><h2>TriangleStrategy.Methods.DDPG module<a class="headerlink" href="#module-TriangleStrategy.Methods.DDPG" title="Permalink to this headline"></a></h2>
<p>DDPG (Deep Deterministic Policy Gradient).</p>
<dl class="py class">
<dt class="sig sig-object py" id="TriangleStrategy.Methods.DDPG.DecisionMakerDDPG">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">TriangleStrategy.Methods.DDPG.</span></span><span class="sig-name descname"><span class="pre">DecisionMakerDDPG</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">head_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tail_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">device(type='cuda')</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#TriangleStrategy.Methods.DDPG.DecisionMakerDDPG" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>The decision maker of DDPG.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>head_mask (int): <code class="docutils literal notranslate"><span class="pre">head_mask</span></code>.
tail_mask (int): <code class="docutils literal notranslate"><span class="pre">tail_mask</span></code>.
device (torch.device): The computing device.</p>
</dd>
<dt>Attributes:</dt><dd><p>training (bool): If <code class="docutils literal notranslate"><span class="pre">training=True</span></code>, <code class="docutils literal notranslate"><span class="pre">model.train()</span></code> will be called and epsilon-greedy strategy will be enabled. If <code class="docutils literal notranslate"><span class="pre">training=False</span></code>, <code class="docutils literal notranslate"><span class="pre">model.eval()</span></code> will be called and epsilon-greedy strategy will be disabled.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="TriangleStrategy.Methods.DDPG.TrainerDDPG">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">TriangleStrategy.Methods.DDPG.</span></span><span class="sig-name descname"><span class="pre">TrainerDDPG</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">head_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tail_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">220</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buy_cost_pct</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sell_cost_pct</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.99</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_tao</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">warm_up_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">device(type='cuda')</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#TriangleStrategy.Methods.DDPG.TrainerDDPG" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>The trainer of DQN.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>head_mask (int): <code class="docutils literal notranslate"><span class="pre">head_mask</span></code>.
tail_mask (int): <code class="docutils literal notranslate"><span class="pre">tail_mask</span></code>.
buy_cost_pct (float): The cost ratio when the agent chooses to buy.
sell_cost_pct (float): The cost ratio when the agent chooses to sell.
gamma (float): The discount factor in the reward value function.
noise_size (float): The variance of random noise on action values.
target_tao (float): The coefficient for target model updating.
warm_up_epoch (int): The number of epochs for warming up. At the first <code class="docutils literal notranslate"><span class="pre">warm_up_epoch</span></code> epochs, only critic model is updated.
device (torch.device): The computing device.</p>
</dd>
<dt>Attributes:</dt><dd><p>difficulty (float): <code class="docutils literal notranslate"><span class="pre">difficulty</span></code>.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="TriangleStrategy.Methods.DDPG.TrainerDDPG.get_reward">
<span class="sig-name descname"><span class="pre">get_reward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buy_price_batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sell_price_batch</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#TriangleStrategy.Methods.DDPG.TrainerDDPG.get_reward" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TriangleStrategy.Methods.DDPG.TrainerDDPG.test_epoch">
<span class="sig-name descname"><span class="pre">test_epoch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_loader</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#TriangleStrategy.Methods.DDPG.TrainerDDPG.test_epoch" title="Permalink to this definition"></a></dt>
<dd><p>Test the model for an epoch.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>model (A list that contains 4 torch.nn.Module): The neural network model, including actor_model, critic_model, target_actor, target_critic.
data_loader (torch.utils.data.DataLoader): The data loader which contains the <code class="docutils literal notranslate"><span class="pre">test</span></code> dataset.</p>
</dd>
<dt>Returns:</dt><dd><p>sum_loss, sum_reward (float, float): The average loss and reward of each sequence in the data loader.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TriangleStrategy.Methods.DDPG.TrainerDDPG.train_epoch">
<span class="sig-name descname"><span class="pre">train_epoch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#TriangleStrategy.Methods.DDPG.TrainerDDPG.train_epoch" title="Permalink to this definition"></a></dt>
<dd><p>Train the model for an epoch.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>model (A list that contains 4 torch.nn.Module): The neural network model, including actor_model, critic_model, target_actor, target_critic.
data_loader (torch.utils.data.DataLoader): The data loader which contains the <code class="docutils literal notranslate"><span class="pre">train</span></code> dataset.
optimizer (A list that contains 2 torch.optim.Adam): The optimizer provided by PyTorch, including actor_optimizer, critic_optimizer.</p>
</dd>
<dt>Returns:</dt><dd><p>sum_loss, sum_reward (float, float): The average loss and reward of each sequence in the data loader.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TriangleStrategy.Methods.DDPG.TrainerDDPG.update_target_network">
<span class="sig-name descname"><span class="pre">update_target_network</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_target</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#TriangleStrategy.Methods.DDPG.TrainerDDPG.update_target_network" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-TriangleStrategy.Methods.DQN">
<span id="trianglestrategy-methods-dqn-module"></span><h2>TriangleStrategy.Methods.DQN module<a class="headerlink" href="#module-TriangleStrategy.Methods.DQN" title="Permalink to this headline"></a></h2>
<p>DQN (Deep Q network).</p>
<dl class="py class">
<dt class="sig sig-object py" id="TriangleStrategy.Methods.DQN.DecisionMakerDQN">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">TriangleStrategy.Methods.DQN.</span></span><span class="sig-name descname"><span class="pre">DecisionMakerDQN</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">head_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tail_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">device(type='cuda')</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#TriangleStrategy.Methods.DQN.DecisionMakerDQN" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>The decision maker of DQN.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>head_mask (int): <code class="docutils literal notranslate"><span class="pre">head_mask</span></code>.
tail_mask (int): <code class="docutils literal notranslate"><span class="pre">tail_mask</span></code>.
epsilon (float): The probability that the agent chooses actions randomly.
device (torch.device): The computing device.</p>
</dd>
<dt>Attributes:</dt><dd><p>epsilon (float): The probability that the agent chooses actions randomly. We recommend setting it to 1 initially and then decreasing it to 0.01.
training (bool): If <code class="docutils literal notranslate"><span class="pre">training=True</span></code>, <code class="docutils literal notranslate"><span class="pre">model.train()</span></code> will be called and epsilon-greedy strategy will be enabled. If <code class="docutils literal notranslate"><span class="pre">training=False</span></code>, <code class="docutils literal notranslate"><span class="pre">model.eval()</span></code> will be called and epsilon-greedy strategy will be disabled.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="TriangleStrategy.Methods.DQN.DecisionMakerDQN.get_model_output">
<span class="sig-name descname"><span class="pre">get_model_output</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#TriangleStrategy.Methods.DQN.DecisionMakerDQN.get_model_output" title="Permalink to this definition"></a></dt>
<dd><p>Get the raw output of a model.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>model (torch.nn.Module): The neural network model.
input_data (torch.tensor): A batch of sequencial environment states. The shape is <code class="docutils literal notranslate"><span class="pre">(batch_size,</span> <span class="pre">sequence_length,</span> <span class="pre">input_size)</span></code>.
action_data (torch.tensor): A batch of sequencial actions. The shape is <code class="docutils literal notranslate"><span class="pre">(batch_size,</span> <span class="pre">sequence_length)</span></code>. This tensor is generated in trainer.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="TriangleStrategy.Methods.DQN.TrainerDQN">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">TriangleStrategy.Methods.DQN.</span></span><span class="sig-name descname"><span class="pre">TrainerDQN</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">head_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tail_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buy_cost_pct</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sell_cost_pct</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.99</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">huber_loss_delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clamp_bound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_tao</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">device(type='cuda')</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#TriangleStrategy.Methods.DQN.TrainerDQN" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>The trainer of DQN.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>head_mask (int): <code class="docutils literal notranslate"><span class="pre">head_mask</span></code>.
tail_mask (int): <code class="docutils literal notranslate"><span class="pre">tail_mask</span></code>.
buy_cost_pct (float): The cost ratio when the agent chooses to buy.
sell_cost_pct (float): The cost ratio when the agent chooses to sell.
gamma (float): The discount factor in the reward value function.
huber_loss_delta (float): The delta value in huber loss function.
clamp_bound (float): The upper bound on the absolute value of the gradients.
target_tao (float): The coefficient for target model updating.
device (torch.device): The computing device.</p>
</dd>
<dt>Attributes:</dt><dd><p>difficulty (float): <code class="docutils literal notranslate"><span class="pre">difficulty</span></code>.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="TriangleStrategy.Methods.DQN.TrainerDQN.calculate_loss">
<span class="sig-name descname"><span class="pre">calculate_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decision_maker</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_data_batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buy_price_batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sell_price_batch</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#TriangleStrategy.Methods.DQN.TrainerDQN.calculate_loss" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TriangleStrategy.Methods.DQN.TrainerDQN.test_epoch">
<span class="sig-name descname"><span class="pre">test_epoch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_loader</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#TriangleStrategy.Methods.DQN.TrainerDQN.test_epoch" title="Permalink to this definition"></a></dt>
<dd><p>Test the model for an epoch.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>model (torch.nn.Module): The neural network model.
data_loader (torch.utils.data.DataLoader): The data loader which contains the <code class="docutils literal notranslate"><span class="pre">dev</span> <span class="pre">(or</span> <span class="pre">test)</span></code> dataset.
decision_maker (DecisionMakerDQN): The decision maker that chooses actions according to the model’s output.
model_target (torch.nn.Module): The target model in DQN.</p>
</dd>
<dt>Returns:</dt><dd><p>sum_loss, sum_reward (float, float): The average loss and reward of each sequence in the data loader.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TriangleStrategy.Methods.DQN.TrainerDQN.train_epoch">
<span class="sig-name descname"><span class="pre">train_epoch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#TriangleStrategy.Methods.DQN.TrainerDQN.train_epoch" title="Permalink to this definition"></a></dt>
<dd><p>Train the model for an epoch.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>model (torch.nn.Module): The neural network model.
data_loader (torch.utils.data.DataLoader): The data loader which contains the <code class="docutils literal notranslate"><span class="pre">train</span></code> dataset.
optimizer (torch.optim.Adam): The optimizer provided by PyTorch.
decision_maker (DecisionMakerDQN): The decision maker that chooses actions according to the model’s output.
model_target (torch.nn.Module): The target model in DQN.</p>
</dd>
<dt>Returns:</dt><dd><p>sum_loss, sum_reward (float, float): The average loss and reward of each sequence in the data loader.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TriangleStrategy.Methods.DQN.TrainerDQN.update_target_network">
<span class="sig-name descname"><span class="pre">update_target_network</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_target</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#TriangleStrategy.Methods.DQN.TrainerDQN.update_target_network" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-TriangleStrategy.Methods.DQNA">
<span id="trianglestrategy-methods-dqna-module"></span><h2>TriangleStrategy.Methods.DQNA module<a class="headerlink" href="#module-TriangleStrategy.Methods.DQNA" title="Permalink to this headline"></a></h2>
<p>DQN-A (Deep Q Network-Action Augmentation).</p>
<dl class="py class">
<dt class="sig sig-object py" id="TriangleStrategy.Methods.DQNA.DecisionMakerDQNA">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">TriangleStrategy.Methods.DQNA.</span></span><span class="sig-name descname"><span class="pre">DecisionMakerDQNA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">head_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tail_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">device(type='cuda')</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#TriangleStrategy.Methods.DQNA.DecisionMakerDQNA" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>The decision maker of DQN-A.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>head_mask (int): <code class="docutils literal notranslate"><span class="pre">head_mask</span></code>.
tail_mask (int): <code class="docutils literal notranslate"><span class="pre">tail_mask</span></code>.
device (torch.device): The computing device.</p>
</dd>
<dt>Attributes:</dt><dd><p>training (bool): If <code class="docutils literal notranslate"><span class="pre">training=True</span></code>, <code class="docutils literal notranslate"><span class="pre">model.train()</span></code> will be called. If <code class="docutils literal notranslate"><span class="pre">training=False</span></code>, <code class="docutils literal notranslate"><span class="pre">model.eval()</span></code> will be called.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="TriangleStrategy.Methods.DQNA.DecisionMakerDQNA.get_model_output">
<span class="sig-name descname"><span class="pre">get_model_output</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#TriangleStrategy.Methods.DQNA.DecisionMakerDQNA.get_model_output" title="Permalink to this definition"></a></dt>
<dd><p>Get the raw output of a model.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>model (torch.nn.Module): The neural network model.
input_data (torch.tensor): A batch of sequencial environment states. The shape is <code class="docutils literal notranslate"><span class="pre">(batch_size,</span> <span class="pre">sequence_length,</span> <span class="pre">input_size)</span></code>.
action_data (torch.tensor): A batch of sequencial actions. The shape is <code class="docutils literal notranslate"><span class="pre">(batch_size,</span> <span class="pre">sequence_length)</span></code>. This tensor is generated in trainer.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="TriangleStrategy.Methods.DQNA.TrainerDQNA">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">TriangleStrategy.Methods.DQNA.</span></span><span class="sig-name descname"><span class="pre">TrainerDQNA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">head_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tail_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buy_cost_pct</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sell_cost_pct</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.99</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">huber_loss_delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clamp_bound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_tao</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">device(type='cuda')</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#TriangleStrategy.Methods.DQNA.TrainerDQNA" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>The trainer of DQN-A.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>head_mask (int): <code class="docutils literal notranslate"><span class="pre">head_mask</span></code>.
tail_mask (int): <code class="docutils literal notranslate"><span class="pre">tail_mask</span></code>.
buy_cost_pct (float): The cost ratio when the agent chooses to buy.
sell_cost_pct (float): The cost ratio when the agent chooses to sell.
gamma (float): The discount factor in the reward value function.
huber_loss_delta (float): The delta value in huber loss function.
clamp_bound (float): The upper bound on the absolute value of the gradients.
target_tao (float): The coefficient for target model updating.
device (torch.device): The computing device.</p>
</dd>
<dt>Attributes:</dt><dd><p>difficulty (float): <code class="docutils literal notranslate"><span class="pre">difficulty</span></code>.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="TriangleStrategy.Methods.DQNA.TrainerDQNA.calculate_loss">
<span class="sig-name descname"><span class="pre">calculate_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decision_maker</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_data_batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buy_price_batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sell_price_batch</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#TriangleStrategy.Methods.DQNA.TrainerDQNA.calculate_loss" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TriangleStrategy.Methods.DQNA.TrainerDQNA.completely_explore">
<span class="sig-name descname"><span class="pre">completely_explore</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action_series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buy_price_series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sell_price_series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buy_cost_pct</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sell_cost_pct</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#TriangleStrategy.Methods.DQNA.TrainerDQNA.completely_explore" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TriangleStrategy.Methods.DQNA.TrainerDQNA.test_epoch">
<span class="sig-name descname"><span class="pre">test_epoch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_loader</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#TriangleStrategy.Methods.DQNA.TrainerDQNA.test_epoch" title="Permalink to this definition"></a></dt>
<dd><p>Test the model for an epoch.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>model (torch.nn.Module): The neural network model.
data_loader (torch.utils.data.DataLoader): The data loader which contains the <code class="docutils literal notranslate"><span class="pre">dev</span> <span class="pre">(or</span> <span class="pre">test)</span></code> dataset.
decision_maker (DecisionMakerDQNA): The decision maker that chooses actions according to the model’s output.
model_target (torch.nn.Module): The target model in DQN.</p>
</dd>
<dt>Returns:</dt><dd><p>sum_loss, sum_reward (float, float): The average loss and reward of each sequence in the data loader.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TriangleStrategy.Methods.DQNA.TrainerDQNA.train_epoch">
<span class="sig-name descname"><span class="pre">train_epoch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#TriangleStrategy.Methods.DQNA.TrainerDQNA.train_epoch" title="Permalink to this definition"></a></dt>
<dd><p>Train the model for an epoch.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>model (torch.nn.Module): The neural network model.
data_loader (torch.utils.data.DataLoader): The data loader which contains the <code class="docutils literal notranslate"><span class="pre">train</span></code> dataset.
optimizer (torch.optim.Adam): The optimizer provided by PyTorch.
decision_maker (DecisionMakerDQNA): The decision maker that chooses actions according to the model’s output.
model_target (torch.nn.Module): The target model in DQN.</p>
</dd>
<dt>Returns:</dt><dd><p>sum_loss, sum_reward (float, float): The average loss and reward of each sequence in the data loader.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TriangleStrategy.Methods.DQNA.TrainerDQNA.update_money">
<span class="sig-name descname"><span class="pre">update_money</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action_last</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_now</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buy_price</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sell_price</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buy_cost_pct</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sell_cost_pct</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_money</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#TriangleStrategy.Methods.DQNA.TrainerDQNA.update_money" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TriangleStrategy.Methods.DQNA.TrainerDQNA.update_target_network">
<span class="sig-name descname"><span class="pre">update_target_network</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_target</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#TriangleStrategy.Methods.DQNA.TrainerDQNA.update_target_network" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-TriangleStrategy.Methods.OASS">
<span id="trianglestrategy-methods-oass-module"></span><h2>TriangleStrategy.Methods.OASS module<a class="headerlink" href="#module-TriangleStrategy.Methods.OASS" title="Permalink to this headline"></a></h2>
<p>OASS (Optimal Action Space Search). Coming soooooooooon…</p>
</section>
<section id="module-TriangleStrategy.Methods.PG">
<span id="trianglestrategy-methods-pg-module"></span><h2>TriangleStrategy.Methods.PG module<a class="headerlink" href="#module-TriangleStrategy.Methods.PG" title="Permalink to this headline"></a></h2>
<p>PG (Policy Gradiant).</p>
<dl class="py class">
<dt class="sig sig-object py" id="TriangleStrategy.Methods.PG.DecisionMakerPG">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">TriangleStrategy.Methods.PG.</span></span><span class="sig-name descname"><span class="pre">DecisionMakerPG</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">head_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tail_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">device(type='cuda')</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#TriangleStrategy.Methods.PG.DecisionMakerPG" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>The decision maker of PG.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>head_mask (int): <code class="docutils literal notranslate"><span class="pre">head_mask</span></code>.
tail_mask (int): <code class="docutils literal notranslate"><span class="pre">tail_mask</span></code>.
device (torch.device): The computing device.</p>
</dd>
<dt>Attributes:</dt><dd><p>training (bool): If <code class="docutils literal notranslate"><span class="pre">training=True</span></code>, <code class="docutils literal notranslate"><span class="pre">model.train()</span></code> will be called. If <code class="docutils literal notranslate"><span class="pre">training=False</span></code>, <code class="docutils literal notranslate"><span class="pre">model.eval()</span></code> will be called.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="TriangleStrategy.Methods.PG.DecisionMakerPG.get_model_output">
<span class="sig-name descname"><span class="pre">get_model_output</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#TriangleStrategy.Methods.PG.DecisionMakerPG.get_model_output" title="Permalink to this definition"></a></dt>
<dd><p>Get the raw output of a model.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>model (torch.nn.Module): The neural network model.
input_data (torch.tensor): A batch of sequencial environment states. The shape is <code class="docutils literal notranslate"><span class="pre">(batch_size,</span> <span class="pre">sequence_length,</span> <span class="pre">input_size)</span></code>.
action_data (torch.tensor): A batch of sequencial actions. The shape is <code class="docutils literal notranslate"><span class="pre">(batch_size,</span> <span class="pre">sequence_length)</span></code>. This tensor is generated in trainer.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="TriangleStrategy.Methods.PG.TrainerPG">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">TriangleStrategy.Methods.PG.</span></span><span class="sig-name descname"><span class="pre">TrainerPG</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">head_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tail_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buy_cost_pct</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sell_cost_pct</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.99</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clamp_bound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">device(type='cuda')</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#TriangleStrategy.Methods.PG.TrainerPG" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>The trainer of PG.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>head_mask (int): <code class="docutils literal notranslate"><span class="pre">head_mask</span></code>.
tail_mask (int): <code class="docutils literal notranslate"><span class="pre">tail_mask</span></code>.
buy_cost_pct (float): The cost ratio when the agent chooses to buy.
sell_cost_pct (float): The cost ratio when the agent chooses to sell.
gamma (float): The discount factor in the reward value function.
clamp_bound (float): The upper bound on the absolute value of the gradients.
device (torch.device): The computing device.</p>
</dd>
<dt>Attributes:</dt><dd><p>difficulty (float): <code class="docutils literal notranslate"><span class="pre">difficulty</span></code>.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="TriangleStrategy.Methods.PG.TrainerPG.calculate_loss">
<span class="sig-name descname"><span class="pre">calculate_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decision_maker</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_data_batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buy_price_batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sell_price_batch</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#TriangleStrategy.Methods.PG.TrainerPG.calculate_loss" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TriangleStrategy.Methods.PG.TrainerPG.test_epoch">
<span class="sig-name descname"><span class="pre">test_epoch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_loader</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#TriangleStrategy.Methods.PG.TrainerPG.test_epoch" title="Permalink to this definition"></a></dt>
<dd><p>Test the model for an epoch.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>model (torch.nn.Module): The neural network model.
data_loader (torch.utils.data.DataLoader): The data loader which contains the <code class="docutils literal notranslate"><span class="pre">dev</span> <span class="pre">(or</span> <span class="pre">test)</span></code> dataset.
decision_maker (DecisionMakerPG): The decision maker that chooses actions according to the model’s output.</p>
</dd>
<dt>Returns:</dt><dd><p>sum_loss, sum_reward (float, float): The average loss and reward of each sequence in the data loader.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TriangleStrategy.Methods.PG.TrainerPG.train_epoch">
<span class="sig-name descname"><span class="pre">train_epoch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#TriangleStrategy.Methods.PG.TrainerPG.train_epoch" title="Permalink to this definition"></a></dt>
<dd><p>Train the model for an epoch.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>model (torch.nn.Module): The neural network model.
data_loader (torch.utils.data.DataLoader): The data loader which contains the <code class="docutils literal notranslate"><span class="pre">train</span></code> dataset.
optimizer (torch.optim.Adam): The optimizer provided by PyTorch.
decision_maker (DecisionMakerPG): The decision maker that chooses actions according to the model’s output.</p>
</dd>
<dt>Returns:</dt><dd><p>sum_loss, sum_reward (float, float): The average loss and reward of each sequence in the data loader.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-TriangleStrategy.Methods.PPO">
<span id="trianglestrategy-methods-ppo-module"></span><h2>TriangleStrategy.Methods.PPO module<a class="headerlink" href="#module-TriangleStrategy.Methods.PPO" title="Permalink to this headline"></a></h2>
<p>PPO (Proximal Policy Optimization).</p>
<dl class="py class">
<dt class="sig sig-object py" id="TriangleStrategy.Methods.PPO.DecisionMakerPPO">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">TriangleStrategy.Methods.PPO.</span></span><span class="sig-name descname"><span class="pre">DecisionMakerPPO</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">head_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tail_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">device(type='cuda')</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#TriangleStrategy.Methods.PPO.DecisionMakerPPO" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>The decision maker of PPO.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>head_mask (int): <code class="docutils literal notranslate"><span class="pre">head_mask</span></code>.
tail_mask (int): <code class="docutils literal notranslate"><span class="pre">tail_mask</span></code>.
device (torch.device): The computing device.</p>
</dd>
<dt>Attributes:</dt><dd><p>training (bool): If <code class="docutils literal notranslate"><span class="pre">training=True</span></code>, <code class="docutils literal notranslate"><span class="pre">model.train()</span></code> will be called. If <code class="docutils literal notranslate"><span class="pre">training=False</span></code>, <code class="docutils literal notranslate"><span class="pre">model.eval()</span></code> will be called.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="TriangleStrategy.Methods.PPO.DecisionMakerPPO.get_model_output">
<span class="sig-name descname"><span class="pre">get_model_output</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#TriangleStrategy.Methods.PPO.DecisionMakerPPO.get_model_output" title="Permalink to this definition"></a></dt>
<dd><p>Get the raw output of a model.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>model (torch.nn.Module): The neural network model.
input_data (torch.tensor): A batch of sequencial environment states. The shape is <code class="docutils literal notranslate"><span class="pre">(batch_size,</span> <span class="pre">sequence_length,</span> <span class="pre">input_size)</span></code>.
action_data (torch.tensor): A batch of sequencial actions. The shape is <code class="docutils literal notranslate"><span class="pre">(batch_size,</span> <span class="pre">sequence_length)</span></code>. This tensor is generated in trainer.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="TriangleStrategy.Methods.PPO.TrainerPPO">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">TriangleStrategy.Methods.PPO.</span></span><span class="sig-name descname"><span class="pre">TrainerPPO</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">head_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tail_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buy_cost_pct</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sell_cost_pct</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.99</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">huber_loss_delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_tao</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clamp_bound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">device(type='cuda')</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#TriangleStrategy.Methods.PPO.TrainerPPO" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>The trainer of PPO.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>head_mask (int): <code class="docutils literal notranslate"><span class="pre">head_mask</span></code>.
tail_mask (int): <code class="docutils literal notranslate"><span class="pre">tail_mask</span></code>.
buy_cost_pct (float): The cost ratio when the agent chooses to buy.
sell_cost_pct (float): The cost ratio when the agent chooses to sell.
gamma (float): The discount factor in the reward value function.
eps (float): The bound value in PPO.
huber_loss_delta (float): The delta value in huber loss function.
target_tao (float): The coefficient for target (old) model updating.
clamp_bound (float): The upper bound on the absolute value of the gradients.
device (torch.device): The computing device.</p>
</dd>
<dt>Attributes:</dt><dd><p>difficulty (float): <code class="docutils literal notranslate"><span class="pre">difficulty</span></code>.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="TriangleStrategy.Methods.PPO.TrainerPPO.calculate_loss">
<span class="sig-name descname"><span class="pre">calculate_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decision_maker</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_data_batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buy_price_batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sell_price_batch</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#TriangleStrategy.Methods.PPO.TrainerPPO.calculate_loss" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TriangleStrategy.Methods.PPO.TrainerPPO.test_epoch">
<span class="sig-name descname"><span class="pre">test_epoch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_loader</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#TriangleStrategy.Methods.PPO.TrainerPPO.test_epoch" title="Permalink to this definition"></a></dt>
<dd><p>Test the model for an epoch.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>model (A list that contains 4 torch.nn.Module): The neural network model, including actor_model, critic_model, actor_model_old, critic_model_old.
data_loader (torch.utils.data.DataLoader): The data loader which contains the <code class="docutils literal notranslate"><span class="pre">test</span></code> dataset.
decision_maker (DecisionMakerPPO): The decision maker that chooses actions according to the model’s output.</p>
</dd>
<dt>Returns:</dt><dd><p>sum_loss, sum_reward (float, float): The average loss and reward of each sequence in the data loader.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TriangleStrategy.Methods.PPO.TrainerPPO.train_epoch">
<span class="sig-name descname"><span class="pre">train_epoch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#TriangleStrategy.Methods.PPO.TrainerPPO.train_epoch" title="Permalink to this definition"></a></dt>
<dd><p>Train the model for an epoch.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>model (A list that contains 4 torch.nn.Module): The neural network model, including actor_model, critic_model, actor_model_old, critic_model_old.
data_loader (torch.utils.data.DataLoader): The data loader which contains the <code class="docutils literal notranslate"><span class="pre">train</span></code> dataset.
optimizer (A list that contains 2 torch.optim.Adam): The optimizer provided by PyTorch, including actor_optimizer, critic_optimizer.
decision_maker (DecisionMakerPPO): The decision maker that chooses actions according to the model’s output.</p>
</dd>
<dt>Returns:</dt><dd><p>sum_loss, sum_reward (float, float): The average loss and reward of each sequence in the data loader.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TriangleStrategy.Methods.PPO.TrainerPPO.update_target_network">
<span class="sig-name descname"><span class="pre">update_target_network</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_target</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#TriangleStrategy.Methods.PPO.TrainerPPO.update_target_network" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="TriangleStrategy.html" class="btn btn-neutral float-left" title="TriangleStrategy package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Artiprocher.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>